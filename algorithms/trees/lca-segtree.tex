\subsection{LCA SegTree (CP Algo)}

The algorithm can answer each query in $O(\log N)$ with preprocessing in $O(N)$ time.
